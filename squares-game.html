<!DOCTYPE html>
<!-- Created by Hughesmath -->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=10.0, user-scalable=yes">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <title>Squares Game - Practice Mode</title>
  <style>
    :root {
      --circle-size: clamp(8px, 5vw, 50px);
      --circle-border: clamp(1px, 0.5vw, 5px);
      --circle-total: calc(var(--circle-size) + var(--circle-border) * 2);
    }
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      min-height: 100vh;
      background: #000;
      color: #fff;
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
      overflow-y: auto;
    }
    .game-container {
      width: 100%;
      max-width: 1200px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 30px;
    }
    .game-navigation {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .game-nav-button {
      padding: 15px 30px;
      font-size: 20px;
      font-weight: bold;
      background: transparent;
      color: #fff;
      border: 3px solid #fff;
      border-radius: 999px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
    }
    .game-nav-button:hover {
      background: #fff;
      color: #000;
    }
    .game-nav-button.active {
      background: #fff;
      color: #000;
    }
    .level-info {
      text-align: center;
      margin-bottom: 20px;
    }
    .level-title {
      font-size: 32px;
      font-weight: bold;
      margin-bottom: 10px;
    }
    .level-range {
      font-size: 24px;
      color: #aaa;
      margin-bottom: 20px;
    }
    .question-container {
      text-align: center;
      margin-bottom: 30px;
    }
    .question {
      font-size: 48px;
      font-weight: bold;
      margin-bottom: 20px;
    }
    .grid-container {
      display: flex;
      justify-content: center;
      margin-bottom: 30px;
    }
    .grid {
      display: grid;
      gap: 0;
      background: #111;
      padding: 10px;
      border-radius: 10px;
    }
    .circle {
      width: var(--circle-total);
      height: var(--circle-total);
      border-radius: 50%;
      background: #222;
      border: var(--circle-border) solid #fff;
      transition: background 0.2s ease;
    }
    .circle.correct {
      background: #00ff00;
      animation: correctPulse 0.5s ease;
    }
    .circle.incorrect {
      background: #ff0000;
      animation: incorrectShake 0.5s ease;
    }
    @keyframes correctPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    @keyframes incorrectShake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }
    .input-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
      margin-bottom: 30px;
    }
    .answer-input {
      font-size: 48px;
      padding: 20px 40px;
      text-align: center;
      background: #111;
      color: #fff;
      border: 4px solid #fff;
      border-radius: 10px;
      width: 300px;
      max-width: 90vw;
      font-weight: bold;
    }
    .answer-input:focus {
      outline: none;
      border-color: #00ff00;
      box-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
    }
    .feedback {
      font-size: 36px;
      font-weight: bold;
      min-height: 50px;
      transition: opacity 0.3s ease;
    }
    .feedback.correct {
      color: #00ff00;
    }
    .feedback.incorrect {
      color: #ff0000;
    }
    .stats {
      display: flex;
      gap: 30px;
      font-size: 24px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .stat-item {
      text-align: center;
    }
    .stat-value {
      font-size: 36px;
      font-weight: bold;
      color: #00ff00;
    }
    .level-selector {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 30px;
    }
    .level-button {
      padding: 15px 25px;
      font-size: 20px;
      font-weight: bold;
      background: transparent;
      color: #fff;
      border: 2px solid #fff;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .level-button:hover {
      background: #fff;
      color: #000;
    }
    .level-button.active {
      background: #fff;
      color: #000;
    }
    .level-button.completed {
      border-color: #00ff00;
      color: #00ff00;
    }
    .instructions {
      text-align: center;
      font-size: 18px;
      color: #aaa;
      margin-bottom: 20px;
      max-width: 600px;
    }
    /* On-screen number pad */
    .number-pad {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      max-width: 400px;
      margin: 20px auto;
    }
    .number-pad-button {
      padding: 25px;
      font-size: 32px;
      font-weight: bold;
      background: #222;
      color: #fff;
      border: 3px solid #fff;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.2s ease;
      user-select: none;
    }
    .number-pad-button:hover {
      background: #444;
      transform: scale(1.05);
    }
    .number-pad-button:active {
      background: #666;
      transform: scale(0.95);
    }
    .number-pad-button.clear {
      grid-column: span 2;
      background: #660000;
    }
    .number-pad-button.clear:hover {
      background: #880000;
    }
    .number-pad-button.enter {
      grid-column: span 2;
      background: #006600;
    }
    .number-pad-button.enter:hover {
      background: #008800;
    }
    /* Timer display */
    .timer-container {
      display: flex;
      gap: 20px;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .timer-display {
      font-size: 28px;
      font-weight: bold;
      color: #00ff00;
    }
    .timer-display.warning {
      color: #ffaa00;
    }
    .timer-display.danger {
      color: #ff0000;
      animation: pulse 1s infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    .avg-time {
      font-size: 20px;
      color: #aaa;
    }
    /* Difficulty selector */
    .difficulty-selector {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .difficulty-button {
      padding: 12px 24px;
      font-size: 18px;
      font-weight: bold;
      background: transparent;
      color: #fff;
      border: 2px solid #fff;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .difficulty-button:hover {
      background: #fff;
      color: #000;
    }
    .difficulty-button.active {
      background: #fff;
      color: #000;
    }
    .difficulty-button.easy {
      border-color: #00ff00;
    }
    .difficulty-button.medium {
      border-color: #ffaa00;
    }
    .difficulty-button.hard {
      border-color: #ff0000;
    }
    .difficulty-button.expert {
      border-color: #ff00ff;
    }
    /* Sound toggle */
    .sound-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 10px 20px;
      font-size: 16px;
      background: #222;
      color: #fff;
      border: 2px solid #fff;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .sound-toggle:hover {
      background: #444;
    }
    .sound-toggle.active {
      background: #00ff00;
      color: #000;
    }
  </style>
</head>
<body>
  <div class="game-container">
    <div class="game-navigation">
      <a href="index.html" class="game-nav-button">‚Üê Go Back</a>
      <a href="squares.html" class="game-nav-button">View All Squares</a>
    </div>

    <div class="level-info">
      <div class="level-title">Squares Practice Game</div>
      <div class="instructions">
        Type the answer as fast as you can when you see the grid!
      </div>
    </div>

    <button class="sound-toggle" id="soundToggle">üîä Sound On</button>

    <div class="difficulty-selector" id="difficultySelector">
      <button class="difficulty-button easy active" data-difficulty="easy">Easy</button>
      <button class="difficulty-button medium" data-difficulty="medium">Medium</button>
      <button class="difficulty-button hard" data-difficulty="hard">Hard</button>
      <button class="difficulty-button expert" data-difficulty="expert">Expert</button>
    </div>

    <div class="level-selector" id="levelSelector"></div>

    <div class="level-info">
      <div class="level-range" id="levelRange">Level 1: Squares 1 through 15</div>
    </div>

    <div class="timer-container">
      <div class="timer-display" id="timer">Time: 0.0s</div>
      <div class="avg-time" id="avgTime">Avg: 0.0s</div>
    </div>

    <div class="stats">
      <div class="stat-item">
        <div>Score</div>
        <div class="stat-value" id="score">0</div>
      </div>
      <div class="stat-item">
        <div>Correct</div>
        <div class="stat-value" id="correct">0</div>
      </div>
      <div class="stat-item">
        <div>Wrong</div>
        <div class="stat-value" id="wrong">0</div>
      </div>
      <div class="stat-item">
        <div>Streak</div>
        <div class="stat-value" id="streak">0</div>
      </div>
    </div>

    <div class="question-container">
      <div class="question" id="question">What is 5¬≤?</div>
    </div>

    <div class="grid-container">
      <div class="grid" id="grid"></div>
    </div>

    <div class="input-container">
      <input 
        type="number" 
        class="answer-input" 
        id="answerInput" 
        placeholder="Type answer..."
        autofocus
        autocomplete="off"
      />
      <div class="feedback" id="feedback"></div>
    </div>

    <div class="number-pad" id="numberPad">
      <button class="number-pad-button" data-number="1">1</button>
      <button class="number-pad-button" data-number="2">2</button>
      <button class="number-pad-button" data-number="3">3</button>
      <button class="number-pad-button" data-number="4">4</button>
      <button class="number-pad-button" data-number="5">5</button>
      <button class="number-pad-button" data-number="6">6</button>
      <button class="number-pad-button" data-number="7">7</button>
      <button class="number-pad-button" data-number="8">8</button>
      <button class="number-pad-button" data-number="9">9</button>
      <button class="number-pad-button clear" id="clearButton">Clear</button>
      <button class="number-pad-button" data-number="0">0</button>
      <button class="number-pad-button enter" id="enterButton">Enter</button>
    </div>
  </div>

  <script>
    // Game levels: [start, end] (inclusive)
    // Each level includes the boundary number from previous level for review
    const LEVELS = [
      [1, 15],      // Level 1: Squares 1 through 15
      [15, 25],     // Level 2: Squares 15 through 25 (includes 15 for review)
      [25, 35],     // Level 3: Squares 25 through 35 (includes 25 for review)
      [35, 45],     // Level 4: Squares 35 through 45 (includes 35 for review)
      [45, 55],     // Level 5: Squares 45 through 55 (includes 45 for review)
      [55, 65],     // Level 6: Squares 55 through 65 (includes 55 for review)
      [65, 75],     // Level 7: Squares 65 through 75 (includes 65 for review)
      [75, 85],     // Level 8: Squares 75 through 85 (includes 75 for review)
      [85, 95],     // Level 9: Squares 85 through 95 (includes 85 for review)
      [95, 100]     // Level 10: Squares 95 through 100 (includes 95 for review)
    ];

    let currentLevel = 0;
    let currentNumber = 0;
    let currentAnswer = 0;
    let score = 0;
    let correct = 0;
    let wrong = 0;
    let streak = 0;
    let completedLevels = new Set();
    let difficulty = 'easy';
    let soundEnabled = true;
    let questionStartTime = 0;
    let timerInterval = null;
    let currentTime = 0;
    let answerTimes = [];
    let timeLimit = null; // null = no limit, or seconds for timed mode

    // Initialize level selector
    function initLevelSelector() {
      const selector = document.getElementById('levelSelector');
      LEVELS.forEach((level, index) => {
        const button = document.createElement('button');
        button.className = 'level-button';
        button.textContent = `Level ${index + 1}`;
        if (index === currentLevel) {
          button.classList.add('active');
        }
        if (completedLevels.has(index)) {
          button.classList.add('completed');
        }
        button.addEventListener('click', () => {
          currentLevel = index;
          updateLevelDisplay();
          generateNewQuestion();
          document.querySelectorAll('.level-button').forEach((btn, i) => {
            btn.classList.toggle('active', i === index);
          });
        });
        selector.appendChild(button);
      });
    }

    function updateLevelDisplay() {
      const [start, end] = LEVELS[currentLevel];
      document.getElementById('levelRange').textContent = `Level ${currentLevel + 1}: Squares ${start} through ${end}`;
    }

    // Sound effects
    function playSound(type) {
      if (!soundEnabled) return;
      
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      
      if (type === 'correct') {
        // Pleasant ascending tone
        oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
        oscillator.frequency.setValueAtTime(554, audioContext.currentTime + 0.1);
        oscillator.frequency.setValueAtTime(659, audioContext.currentTime + 0.2);
        oscillator.type = 'sine';
        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.3);
      } else if (type === 'incorrect') {
        // Low buzz
        oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
        oscillator.type = 'sawtooth';
        gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.2);
      } else if (type === 'timeout') {
        // Warning beep
        oscillator.frequency.setValueAtTime(300, audioContext.currentTime);
        oscillator.type = 'square';
        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.1);
      }
    }

    function startTimer() {
      questionStartTime = Date.now();
      currentTime = 0;
      
      if (timerInterval) clearInterval(timerInterval);
      
      timerInterval = setInterval(() => {
        currentTime = (Date.now() - questionStartTime) / 1000;
        updateTimerDisplay();
        
        // Check time limit for hard/expert modes
        if (timeLimit && currentTime >= timeLimit) {
          handleTimeout();
        }
      }, 100);
    }

    function stopTimer() {
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
    }

    function updateTimerDisplay() {
      const timerDisplay = document.getElementById('timer');
      timerDisplay.textContent = `Time: ${currentTime.toFixed(1)}s`;
      
      // Color coding based on time
      timerDisplay.className = 'timer-display';
      if (timeLimit) {
        const remaining = timeLimit - currentTime;
        if (remaining < timeLimit * 0.3) {
          timerDisplay.classList.add('danger');
        } else if (remaining < timeLimit * 0.6) {
          timerDisplay.classList.add('warning');
        }
      }
    }

    function handleTimeout() {
      stopTimer();
      playSound('timeout');
      const feedback = document.getElementById('feedback');
      feedback.textContent = `‚è± Time's up! The answer is ${currentAnswer}`;
      feedback.className = 'feedback incorrect';
      
      wrong++;
      streak = 0;
      updateStats();
      
      setTimeout(() => {
        generateNewQuestion();
      }, 2000);
    }

    function updateAverageTime() {
      if (answerTimes.length > 0) {
        const avg = answerTimes.reduce((a, b) => a + b, 0) / answerTimes.length;
        document.getElementById('avgTime').textContent = `Avg: ${avg.toFixed(1)}s`;
      }
    }

    function generateNewQuestion() {
      stopTimer();
      
      const [start, end] = LEVELS[currentLevel];
      
      // Adjust range based on difficulty
      let adjustedStart = start;
      let adjustedEnd = end;
      
      if (difficulty === 'easy') {
        // Easy: focus on lower numbers in range
        adjustedEnd = Math.min(end, start + Math.floor((end - start) * 0.6));
      } else if (difficulty === 'hard') {
        // Hard: focus on higher numbers in range
        adjustedStart = start + Math.floor((end - start) * 0.4);
      } else if (difficulty === 'expert') {
        // Expert: all numbers, but with time pressure
        timeLimit = 5; // 5 seconds per question
      } else {
        // Medium: full range
        timeLimit = null;
      }
      
      // Generate random number in adjusted range
      currentNumber = Math.floor(Math.random() * (adjustedEnd - adjustedStart + 1)) + adjustedStart;
      currentAnswer = currentNumber * currentNumber;
      
      // Update question
      document.getElementById('question').textContent = `What is ${currentNumber}¬≤?`;
      
      // Clear feedback
      const feedback = document.getElementById('feedback');
      feedback.textContent = '';
      feedback.className = 'feedback';
      
      // Generate grid
      generateGrid(currentNumber);
      
      // Clear and focus input
      const input = document.getElementById('answerInput');
      input.value = '';
      input.focus();
      
      // Start timer
      startTimer();
    }

    function generateGrid(n) {
      const grid = document.getElementById('grid');
      grid.innerHTML = '';
      grid.style.gridTemplateColumns = `repeat(${n}, var(--circle-total))`;
      grid.style.gridTemplateRows = `repeat(${n}, var(--circle-total))`;
      
      const totalDots = n * n;
      for (let i = 0; i < totalDots; i++) {
        const circle = document.createElement('div');
        circle.className = 'circle';
        grid.appendChild(circle);
      }
    }

    function checkAnswer(userAnswer) {
      stopTimer();
      
      const input = document.getElementById('answerInput');
      const feedback = document.getElementById('feedback');
      const circles = document.querySelectorAll('.circle');
      
      // Record answer time
      const answerTime = currentTime;
      
      if (parseInt(userAnswer) === currentAnswer) {
        // Correct!
        answerTimes.push(answerTime);
        updateAverageTime();
        
        feedback.textContent = `‚úì Correct! (${answerTime.toFixed(1)}s)`;
        feedback.className = 'feedback correct';
        circles.forEach(circle => {
          circle.classList.add('correct');
        });
        
        playSound('correct');
        
        correct++;
        streak++;
        
        // Score calculation based on speed and difficulty
        let baseScore = 10;
        let speedBonus = Math.max(0, Math.floor((5 - answerTime) * 2)); // Bonus for fast answers
        let streakBonus = streak * 2;
        let difficultyMultiplier = difficulty === 'easy' ? 1 : difficulty === 'medium' ? 1.5 : difficulty === 'hard' ? 2 : 3;
        
        score += Math.floor((baseScore + speedBonus + streakBonus) * difficultyMultiplier);
        
        // Mark level as completed if all questions answered correctly
        if (correct % 10 === 0) {
          completedLevels.add(currentLevel);
          document.querySelectorAll('.level-button')[currentLevel].classList.add('completed');
        }
        
        updateStats();
        
        // Generate new question after delay
        setTimeout(() => {
          generateNewQuestion();
        }, 1500);
      } else {
        // Wrong!
        feedback.textContent = `‚úó Wrong! The answer is ${currentAnswer}`;
        feedback.className = 'feedback incorrect';
        circles.forEach(circle => {
          circle.classList.add('incorrect');
        });
        
        playSound('incorrect');
        
        wrong++;
        streak = 0;
        updateStats();
        
        // Show correct answer, then generate new question
        setTimeout(() => {
          generateNewQuestion();
        }, 2000);
      }
    }

    function updateStats() {
      document.getElementById('score').textContent = score;
      document.getElementById('correct').textContent = correct;
      document.getElementById('wrong').textContent = wrong;
      document.getElementById('streak').textContent = streak;
    }

    // Handle input
    const answerInput = document.getElementById('answerInput');
    answerInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        const value = answerInput.value.trim();
        if (value !== '') {
          checkAnswer(value);
        }
      }
    });

    // Also check on input change for faster response
    answerInput.addEventListener('input', (e) => {
      const value = e.target.value.trim();
      // Auto-submit when correct number of digits is entered (for small numbers)
      if (currentAnswer < 1000 && value.length === String(currentAnswer).length) {
        // Small delay to allow user to see their input
        setTimeout(() => {
          if (parseInt(value) === currentAnswer) {
            checkAnswer(value);
          }
        }, 100);
      }
    });

    // On-screen number pad
    function initNumberPad() {
      const numberPad = document.getElementById('numberPad');
      const numberButtons = numberPad.querySelectorAll('[data-number]');
      const clearButton = document.getElementById('clearButton');
      const enterButton = document.getElementById('enterButton');
      
      numberButtons.forEach(button => {
        button.addEventListener('click', () => {
          const number = button.getAttribute('data-number');
          answerInput.value += number;
          answerInput.focus();
        });
      });
      
      clearButton.addEventListener('click', () => {
        answerInput.value = '';
        answerInput.focus();
      });
      
      enterButton.addEventListener('click', () => {
        const value = answerInput.value.trim();
        if (value !== '') {
          checkAnswer(value);
        }
      });
    }

    // Difficulty selector
    function initDifficultySelector() {
      const difficultyButtons = document.querySelectorAll('.difficulty-button');
      difficultyButtons.forEach(button => {
        button.addEventListener('click', () => {
          difficulty = button.getAttribute('data-difficulty');
          difficultyButtons.forEach(btn => btn.classList.remove('active'));
          button.classList.add('active');
          generateNewQuestion();
        });
      });
    }

    // Sound toggle
    function initSoundToggle() {
      const soundToggle = document.getElementById('soundToggle');
      soundToggle.addEventListener('click', () => {
        soundEnabled = !soundEnabled;
        soundToggle.textContent = soundEnabled ? 'üîä Sound On' : 'üîá Sound Off';
        soundToggle.classList.toggle('active', soundEnabled);
      });
    }

    // Initialize game
    initLevelSelector();
    initNumberPad();
    initDifficultySelector();
    initSoundToggle();
    updateLevelDisplay();
    generateNewQuestion();
    updateStats();
  </script>
</body>
</html>

